/* ---------------------------------------------------------------------------
   ta3dif.c --- test ACE/S3 data interface
   1998 by Hefti, University of Michigan (hefti@umich.edu)
   $Id: ta3dif.c,v 1.1.1.1 2000/06/02 13:37:23 jraines Exp $
   ------------------------------------------------------------------------ */

#include <stdio.h>
#include <math.h>
#include <stdlib.h>

#include "libhef.h"

char zrcsid[] = "$Id: ta3dif.c,v 1.1.1.1 2000/06/02 13:37:23 jraines Exp $";

int main(int argc, char *argv[] )
{

  FST    fedb;
  int    itmp;
  int    icrres;
  int    ic;

  double *adcnq;

  /* -------------------------------------------------------------------------
  ** start
  ** -----------------------------------------------------------------------*/

  printf("ta3dif --- test ACE/S3 data interface\n");
  printf("1998 by Hefti, University of Michigan (%s)\n",
	 "hefti@umich.edu");
  printf("\n");
  printf("%s\n",zrcsid);
  printf("(%s %s)\n",__DATE__,__TIME__);
  printf("\n");

  /* -------------------------------------------------------------------------
  ** command line
  ** -----------------------------------------------------------------------*/

  if(argc < 2) {
    printf("Usage: ta3dif yyddd\n");
    exit(1);
  }

  /* -------------------------------------------------------------------------
  ** files
  ** -----------------------------------------------------------------------*/

  sprintf(fedb.pan,"%s.nc",argv[1]);

  itmp = a3opencyclefile(fedb.pan);
  if( itmp != 0 ) exit(1);

  /* -------------------------------------------------------------------------
  ** loop over cycles
  ** -----------------------------------------------------------------------*/

  icrres = 0;
  ic     = 0;

  while(icrres == 0 ) /* loop cycles */ {

    icrres = a3readcycle();
    if( icrres != 0 ) break;


    /* -----------------------------------------------------------------------
    ** expand
    ** ---------------------------------------------------------------------*/

    a3expand();

    /* -----------------------------------------------------------------------
    ** print BR table
    ** ---------------------------------------------------------------------*/

    a3pxbrtab(stdout);

    /* -----------------------------------------------------------------------
    ** print E/q table
    ** ---------------------------------------------------------------------*/

    a3pxeqtab(stdout);

    /* -----------------------------------------------------------------------
    ** get CNQ
    ** ---------------------------------------------------------------------*/

    adcnq = a3gcnq();

    printf("ta3dif --- CNQ(U0) = %.3f\n",adcnq[LCNQEOQ0]);

  }

  /* -------------------------------------------------------------------------
  ** done
  ** -----------------------------------------------------------------------*/

  a3closecyclefile();

  return(0);
}
