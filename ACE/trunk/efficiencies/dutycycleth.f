C **********************************************************************

      REAL*4 FUNCTION DUTYCYCLETH( ASPANG, THANG )

C *** This function computes the duty cycle of the SWICS instrument  ***
C *** as a function of the sun aspect angle and the beam opening     ***


C **********************************************************************
C ***                                                                ***
C *** Interface with the main program:                               ***
C *** The main program must hand over:                               ***
C *** ASPANG: REAL*4 containing the sun aspect angle in degrees      *** 
C *** THANG: REAL*4 containing the thermal opening angle in degrees  *** 
C *** Output is a REAL*4 between 0.0 and 0.5, the portion of a       ***
C *** spin during which the sensor sees the solar wind.              ***
C ***                                                                ***
C *** In this version, the effect of a nonzero solar wind            ***
C *** temperature is included.                                       ***    
C ***                                                                ***
C **********************************************************************



C *** Author: Rudolf von Steiger, Physikalisches Institut, Univ. Bern,
C ***         Sidlerstr. 5, CH-3012 Bern, Switzerland
C ***
C *** Date:   October 12, 1992


C **********************************************************************
C **********************************************************************
C **********************************************************************


C     7
C    6|                                                               72
C    ||                                                                |
C *** Beginning of the code. *******************************************
c *** Declaration part. ************************************************


      IMPLICIT NONE

      REAL*4
     .  ASPANG,			  ! solar aspect angle
     .  THANG,			  ! thermal opening angle of beam
     .  D,			  ! interpolated value of duty cycle
     .  ASPARR(30), THARR(7),	  ! array for which D is tabulated
     .  DARR(7,30),               ! tabulated duty cycle values
     .  H1, H2			  ! auxiliary values for interpolation

      INTEGER
     .  I, J			  ! interpolation indices

      DATA
     .  ASPARR /0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0,
     .		3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 15.0, 20.0,
     .		25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 65.0/,
     .  THARR /0.0, 0.5, 1.0, 2.0, 3.0, 5.0, 10.0/,
     .  DARR /0.5000,0.5000,0.4772,0.3413,0.2475,0.1555,0.0794,
     .        0.5000,0.4999,0.4762,0.3407,0.2473,0.1554,0.0794,
     .        0.5000,0.4998,0.4729,0.3389,0.2466,0.1552,0.0793,
     .        0.5000,0.4994,0.4673,0.3359,0.2454,0.1549,0.0793,
     .        0.5000,0.4984,0.4594,0.3318,0.2438,0.1545,0.0793,
     .        0.5000,0.4959,0.4490,0.3267,0.2417,0.1540,0.0792,
     .        0.5000,0.4904,0.4360,0.3205,0.2392,0.1534,0.0791,
     .        0.5000,0.4800,0.4206,0.3134,0.2363,0.1526,0.0790,
     .        0.5000,0.4627,0.4029,0.3056,0.2331,0.1518,0.0789,
     .        0.5000,0.4376,0.3833,0.2970,0.2294,0.1508,0.0788,
     .        0.5000,0.4053,0.3622,0.2879,0.2255,0.1498,0.0786,
     .        0.2324,0.2413,0.2532,0.2372,0.2019,0.1431,0.0777,
     .        0.1668,0.1689,0.1769,0.1872,0.1751,0.1344,0.0764,
     .        0.1312,0.1320,0.1351,0.1464,0.1485,0.1245,0.0748,
     .        0.1084,0.1089,0.1103,0.1178,0.1237,0.1139,0.0729,
     .        0.0925,0.0928,0.0936,0.0981,0.1040,0.1032,0.0707,
     .        0.0808,0.0809,0.0815,0.0841,0.0890,0.0930,0.0684,
     .        0.0717,0.0718,0.0722,0.0737,0.0774,0.0830,0.0659,
     .        0.0645,0.0646,0.0649,0.0660,0.0685,0.0739,0.0632,
     .        0.0432,0.0432,0.0433,0.0436,0.0442,0.0464,0.0496,
     .        0.0328,0.0328,0.0328,0.0329,0.0331,0.0339,0.0373,
     .        0.0266,0.0266,0.0266,0.0267,0.0268,0.0272,0.0293,
     .        0.0226,0.0226,0.0226,0.0226,0.0227,0.0229,0.0241,
     .        0.0198,0.0198,0.0198,0.0198,0.0199,0.0200,0.0205,
     .        0.0178,0.0178,0.0178,0.0178,0.0178,0.0179,0.0176,
     .        0.0163,0.0163,0.0163,0.0163,0.0163,0.0163,0.0149,
     .        0.0152,0.0152,0.0152,0.0152,0.0151,0.0140,0.0119,
     .        0.0144,0.0143,0.0136,0.0116,0.0104,0.0093,0.0085,
     .        0.0000,0.0000,0.0000,0.0008,0.0020,0.0036,0.0054,
     .        0.0000,0.0000,0.0000,0.0000,0.0000,0.0007,0.0028/
	
C *** End of declarations. *********************************************


C *** Algorithm. *******************************************************

      I = 1
      DO WHILE ( THANG.GT.THARR(I+1) .AND. I.LT.6 )
	 I = I + 1
      END DO

      J = 1
      DO WHILE ( ASPANG.GT.ASPARR(J+1) .AND. J.LT.29 )
	 J = J + 1
      END DO

      H1 = ( THANG - THARR(I) ) / ( THARR(I+1) - THARR(I) )
      H2 = ( ASPANG - ASPARR(J) ) / ( ASPARR(J+1) - ASPARR(J) )

      D = ( 1E0 - H1 ) * ( 1E0 - H2 ) * DARR(I,J) +
     .    H1 * ( 1E0 - H2 ) * DARR(I+1,J) + 
     .    ( 1E0 - H1 ) * H2 * DARR(I,J+1) +
     .    H1 * H2 * DARR(I+1,J+1)

      DUTYCYCLETH = D

C *** End of algorithm. ************************************************

      RETURN
      END
