C **************************** 02-07-80 **********************************
	SUBROUTINE FWHM(EINC,RNUC,EFWHM,TFWHM,AUXPAR3)
C   EINC = incident ion energy, before energy loss in detector
C   RNUC = incident ion's nuclear mass (amu)
C   EFWHM = system's electronic noise (FWHM) in keV
C   NFWHM = ion's nuclear contribution to FWHM in keV
C   TFWHM = returned value for total FWHM in keV
C  based on LINDAU calibration data of Dec 1979
C  original version  01-29-80
C  CARBON RESULTS (LINDAU) 02-07-80
	REAL NOISE,NFWHM
	DIMENSION RMASS(9),ENERGY(13),NOISE(13,9)
C                                        NUCLEAR FWHM (KEV) ARRAY
C   PROTONS
	DATA NOISE / .15,.75,1.125,1.5,1.7,1.9,2.48,3.15,3.5,4.85,5.5,
     *	7.0,8.3,
C   HELIUM
     *	.6,4.25,4.55,4.8,5.24,5.54,6.33,7.22,7.54,9.3,11.7,18.,25.,
C   CARBON
     *2.77,11.50,14.50,16.7,19.8,22.0,26.3,29.3,30.0,34.,39.,50.7,60.9,
C   OXYGEN
     *3.4,16.34,21.2,24.7,30.0,34.0,42.8,48.5,49.5,57.,65.,86.,104.,
C   NEON
     *3.58,17.38,24.8,30.3,38.0,43.5,57.5,69.0,72.0,82.0,95.0,125.0,
     *150.0,
C   ARGON
     *5.99,31.18,47.24,62.0,84.0,100.,144.,187.,200.,235.,290.,400.,
     *550.,
C   IRON
     *7.20,34.3,51.0,66.5,90.0,108.,155.,200.,214.,250.,305.,415.,565.,
C   KRYPTON
     *9.87,45.63,67.10,88.21,132.,170.,248.,318.,335.,400.,480.,690.,
     *890.,
C   XENON
     *15.18,66.41,96.32,125.2,182.,238.,340.,430.,450.,550.,680.,1000.,
     *1400. /
C                                           ENERGY (KEV/NUC) ARRAY
	DATA ENERGY / 1.,5.,7.5,10.,15.,20.,40.,80.,100.,300.,1000.,
     *10000.,50000. /
C                                           NUCLEAR MASSS (AMU) ARRAY
	DATA RMASS / 1.,4.,12.,16.,20.,40.,56.,84.,129. /
	RNUCL = RNUC
	ENUC = EINC / RNUCL
	IF(ENUC .LT. 1.) GO TO 200
	IF(ENUC .GT. 50000.) ENUC = 50000.
	IF(RNUCL .GT. RMASS(9)) RNUCL = RMASS(9)
	IE = -1
C   DETERMINE ENERGY BIN
	DO 100 J=1,13
	IF(ENUC .EQ. ENERGY(J)) GO TO 110
	IF(ENUC .LT. ENERGY(J)) GO TO 120
100	CONTINUE
C   TAG TO INDICATE ENUC = ENERGY(J)
110	IE = 0
C   DETERMINE MASS BIN
120	DO 140 I=1,9
	IF(RNUCL .EQ. RMASS(I)) GO TO 150
	IF(RNUCL .LT. RMASS(I)) GO TO 160
140	CONTINUE
C   IF ONE OF ARRAY IONS AND ENERGIES (ENERGY AND RMASS) GO TO 180
150	IF(IE .EQ. 0) GO TO 180
C   RNUCL .EQ. RMASS(I)        BUT      ENUC .NE. ENERGY(J)
	NFWHM=ALOG(NOISE(J,I)/NOISE(J-1,I)) / ALOG(ENERGY(J)/ENERGY(J-1))
	NFWHM = NFWHM * ALOG(ENUC/ENERGY(J)) + ALOG(NOISE(J,I))
	NFWHM = EXP(NFWHM)
	GO TO 300
C   NOT AN ARRAY ELEMENT
160	FWHM1 = ALOG(NOISE(J-1,I)/NOISE(J-1,I-1)) / (RMASS(I)-RMASS(I-1))
	FWHM1 = FWHM1 * (RNUCL - RMASS(I-1)) + ALOG(NOISE(J-1,I-1))
	FWHM2 = ALOG(NOISE(J,I)/NOISE(J,I-1)) / (RMASS(I) - RMASS(I-1))
     1	* (RNUCL -RMASS(I-1)) + ALOG(NOISE(J,I-1))
	IF(IE .EQ. 0 ) GO TO 190
	NFWHM = (FWHM2 - FWHM1) * ALOG(ENUC/ENERGY(J-1))
	NFWHM = NFWHM / ALOG(ENERGY(J) / ENERGY(J-1)) + FWHM1
	NFWHM = EXP(NFWHM)
	GO TO 300
C   ARRAY ELEMENT
180	NFWHM = NOISE(J,I)
	GO TO 300
C   ENUC .EQ. ENERGY(J)     BUT       RNUCL .NE. RMASS(I)
190	NFWHM = EXP(FWHM2)
	GO TO 300
C   ENERGIES LESS THAN 1 KEV/NUCLEON
200	NFWHM = .15 * EINC
C   DETERMINE TOTAL FWHM (ELECTRONIC + NUCLEAR)
        NFWHM = AUXPAR3*NFWHM
300	TFWHM = SQRT(EFWHM*EFWHM + NFWHM*NFWHM)
	RETURN
	END
