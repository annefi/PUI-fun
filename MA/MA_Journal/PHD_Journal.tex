\documentclass{tufte-book}

%%% for no indentation at beginning of paragraph %%%
\makeatletter
% Paragraph indentation and separation for normal text
\renewcommand{\@tufte@reset@par}{%
	\setlength{\RaggedRightParindent}{0.0pc}%
	\setlength{\JustifyingParindent}{1.0pc}%
	\setlength{\parindent}{1pc}%
	\setlength{\parskip}{0pt}%
}
\@tufte@reset@par
% % % % % % % % % % % % % % % % % % % % % % % %

\geometry{textwidth=.6\paperwidth} % for smaller margin
\usepackage[utf8]{inputenc} % für Umlaute etc
\usepackage[ngerman]{babel} % nur damit funktionieren "` Anführungszeichen "'
\usepackage{hyperref} % für Links
\usepackage{enumitem} %for customising itemize, enumerate etc.
\setlist[itemize]{topsep=3pt,itemsep=2ex,partopsep=1ex,parsep=1ex}


\usepackage{amsmath}
\usepackage{wasysym}

%%% Todo and done commands
\usepackage[color=teal!10,textsize=footnotesize, textwidth = 0.2\textwidth]{todonotes} 
%\setuptodonotes{noline}
%\newcommand{\done}[2]{\todo[#1, color=teal!10]{#2}}
\newcommand{\done}[2][]{\todo[color=teal!70, #1]{#2}}

\presetkeys%
{todonotes}%
{noline}{}


\usepackage{datetime} % for date
\usepackage{lipsum}
\newcommand{\newday}[2]{\vspace{2cm}\marginnote{{\Large \textbf{\shortdayofweekname{#1}{#2}{2021}, ~\formatdate{#1}{#2}{2021}}}}}

\newcommand{\newdaytt}[2]{\vspace{2cm}\marginnote{{\Large \textbf{\shortdayofweekname{#1}{#2}{2022}, ~\formatdate{#1}{#2}{2022}}}}}

\begin{document}
\newday{8}{4}
Neues Journal eingerichtet!
Übertrag der Todos aus dem alten MA-Journal:

\begin{itemize}
	\item Journal polishen: ToDo Package und Datum... \done{Journal}
	\item Rechte eingeschränkt? checken \done{Rechte}
	\item Koordinatenkram aufschreiben: Graphik der Koordinatensysteme (Neigung der Erd- und Sonnenachse?!), Ulysses Trajektorie Anwendung? \todo{Koordinatenkram aufschreiben}
	\item in calc\_d90 Division checken: python3-kompatibel? Schaltjahr...? \done{Schaltjahr}
	\item SPICE Skript überarbeiten \todo{Ulysses\_SPICE}
	\begin{itemize}
		\item überlegen, wie ich manuelle Rotation einbaue \todo{instance: rotation by hand}
		\item Winkel einbauen \todo{AspAngles}
		\item Funktion zum Wegschreiben der Trajektorie \todo{Write}
		\item Geschwindigkeiten alt/neu \todo{v}
		\item 3D-Repräsentation überlegen \todo{3D Plot}
	\end{itemize}
	\item Koordinatenskripte überarbeiten: etCoords ersetzen \done{Koordinatenskript}
\end{itemize}
%Weiter: testen, wie gerade der Stand der Plots in ulysses\_spice ist.

\newday{9}{4}
\begin{itemize}
	\item in calc\_d90 Division checken: python3-kompatibel? Schaltjahr...?\\$\Rightarrow$ ersetzt durch //, dann passt es sowohl für Python2 als auch Python3. \\Jetzt noch überlegen, wie das mit den ersten zwei Monaten von Schaltjahren ist. Das passt doch nicht?! Aber evtl. egal, wenn das nur intern benutzt wird und das hier überall gleich gemacht wird...? \\
	$\Rightarrow$ Das ganz Schaltjahr selbst ist um einen Tag verschoben...\\
	Lösung: \\
	offd = offy*365 + (offy.astype(int)+1)//4 \\(statt +2)\\ NACHTRAG 12.11.21: Mit den zwei Monaten hat das nichts zu tun: IM Schaltjahr ist alles in Ordnung - erst in den folgenden Tagen muss ein Tag mehr addiert werden\done{Schaltjahr}
	\item Mit Verena versucht, svn+ssh den Password-Prompt abzugewöhnen. Auf dem Weg mitgenommen:
	\begin{itemize}
		\item \textit{hostname -I} zeigt IP an
		\item \textit{ip a} irgendwie auch, aber auch allerhand anderes...
		\item nach dem Bearbeiten der ~/.bashrc: \textit{source ~/.bashrc´} eingeben
		\item Lösung des Problems: Neues ssh-Schlüsselpaar erzeugen mit \\ \textit{ssh-keygen -t rsa -f ~/.ssh/newkey} (Name ist dann newkey)\\dann \textit{ssh-add /home/asterix/fischer/.ssh/newkey}\\ \textit{ssh-add -L} zeigt public keys des agents an \\ Dann noch den public key in .ssh/authorized\_keys kopieren
	\end{itemize}

\end{itemize}
\newday{25}{5}
Next: Rotation einbauen als Methoden in beiden Unterklassen, dafür Coordinates-Skript checken (hg\_to\_hc oder andersrum etc.), dann versuchen die Plots aus Vortrag zu reproduzieren. Falls Vererbung Quatsch ist: Kein Ding, kann ich leicht wieder zurück bauen!

\newday{7}{6}
Next: 180-360-Grad-Sache bei Long checken (wie war das im anderen Skript? Hab ich die long für HG irgendwo angepasst?). \\
Rotation ist eingepflegt, muss noch getestet werden.\\
Dann weiter Plots reproduzieren.\\
Farben brauchen auch noch eine dringende Überarbeitung.

\newday{21}{6}
Git Passwort Dings läuft aus. Token (PAT) erstellt auf Ubuntu Zuhause. Gespeichert(?) mit \textit{git config --global credential.helper store} \\
Plotfunktionen für Aspect Angle fertig. Als nächstes:
\begin{itemize}
	\item Aspect Angle für SPICE einbauen \done{Aspect Angle SPICE}
	\item Alle Plotfunktionen testen und alte Plots erzeugen, Farben aussuchen... \todo{Plots erstellen}
	\item Docstrings, Kommentare für Funktionen schreiben, oben kurz die Koordinatensysteme zusammen fassen \todo{documentation}
\end{itemize}
[Arbeite im \textit{...new\_inheri.py}-Skript]

\newday{24}{6}
Weiter AspAngle für SPICE schreiben: Unterscheide zwischen EC und EQ. Überlegen, ob ich auch manuelle Berechnung für Archivdaten brauche.

\newday{29}{6}
Fehler in ul\_coordinates, calc\_asp\_angles() gefunden: Berechnung SC, E in RTN war vertauscht. Alle Berechnungen reviewed, aspphi getestet, jetzt noch asptheta testen. Evtl. RTN \textit{nochmal} durchdenken oder testen.

\newday{5}{7}
Aspect Angles und entsprechende Plotfunktionen laufen auf SPICE HCI, SPICE ECLIPJ2000 und Archive Data EQ. Allerdings weicht SPICE ECLIPJ2000 manchmal etwas ab. Woran liegt das? \todo{Abweichung AA}\\
Außerdem unbedingt die Plotfunktionen verbessern:
\begin{itemize}
	\item Farben \todo{Farben}
	\item Achsenbeschriftungen \todo{Achsen}
	\item Polar Pass Marker \todo{Passes}
\end{itemize}

\newday{8}{7}
Angefangen, 3D-Plot zu schreiben. Als nächstes: Alles irgendwie größer machen, Ekliptik einfärben, dann Achsen...

\newday{9}{7}
Ekliptik ausmalen: Rausfinden, wo der Endpunkt sein muss oder das einfach geometrisch statt über die datetimes lösen. \done{Ekl. ausmalen}\\ 
Plot aus der Klasse rausnehmen? (Evtl. will ich verschiedene RF darstellen -> dann ists blöd als Klassenmethode?!) Was will ich damit überhaupt?
\begin{itemize}
	\item Widderpunkt Achse \done{Widderpunkt}
	\item kart. ekliptisches System Achsen \done{ecl. Sys.}
	\item Sonne Rotationsachse \done{Sonnenrot.achse}
	\item kart. equatoriales System Achsen \done{equ. Sys.}
	\item SC-Position \todo{SC pos.}
	\item Erde Position \todo{Earth pos.}
	\item optionale Sachen UI? \todo{UI}
	\item evtl. RTN-System \todo{RTN}
	\item evtl. AA-Winkel \todo{AA}
	\item evtl. optional sphärische Winkel einzeichen \todo{sphärische Winkel}
\end{itemize}

\newday{14}{7}
aktuellen Problem: Widderzeichen in Matplotlib bekommen: $\textbf{{\LARGE \aries}}$ \done{$\aries$}

\newday{16}{7}
\begin{itemize}
	\item SW-Meeting: Duncan stellt mpq-Filter-Model vor (Folien anfragen? Interessant.)
\end{itemize}

\newday{19}{7}
3D-Plot eq. Koordinatensystem. Dafür ganzes Skript in Klasse umgebaut.\\
Erd(meinet ich Sonnen-?)rotationsachse einzeichnen\todo{Erdrotationsachse}\\
Habe eq. Koordinatensystem gezeichnet, zumindest x- und y-Achse. Es fehlen z-Achse und die Ebene. Vermutlich ist es schlauer, eine Methode zu schreiben, die alles direkt transformiert?

\newday{20}{7}
$\omega$ $\boldsymbol{\omega}$ \\
Fertig mit den Koordinatensystemen! \\
Alles ordentlich dokumentieren \done{doku}\\
Ulysses einzeichnen... erstmal Punkt, dann verbinden mit Traj-Klasse \done{ulysses}\\
Evtl. Koordinatenachsen dezenter/kürzer für bessere Übersichtlichkeit \todo{achsen}
Testen, ob ich Sonnenrotationsachse auch manuell einzeichnen kann (momentan alles über Rotation des HC-Systems. Müsste ja eigentlich dasselbe sein...) \todo{Test Sonnenachse}

\newday{21}{7}
transform2eq in ndarray-kompatible Form umschreiben, dann das ganze auf die scatter-Plot-Funktion anwenden, dann mal gucken, was ich eigentlich direkt in der init brauche (Funktion in traj\_uly schreiben)

\newday{5}{8}
Keine Ahnung, wo genau ich dran war. Ich glaube, dass die scatter-Funktion (plot\_point()) funktioniert. Dann kann ich jetzt eine Funktion in TrajectoryUlysses schreiben...?\\ Problem: circular import fixen beim Aufruf von plot\_3d in spice\_ulysses. Was brauche ich aus spice\_ulysses in plot\_3d? \done{circular import fixen}

\newday{30}{8}
Circular Import versucht zu fixen. Problem: spice\_ulysses.py importiert plot\_3d-Klasse, um dann Datensätze darzustellen. Aber in spice\_ulysses.py sitzen die ganzen SPICE-Funktionen, die ich brauche, um z.B. den Äquator zu zeichnen. Plan: Funktionen, die in beiden gebraucht werden (und zugehörige) in a) ul\_coordinates\_utils oder b) in ein neues SPICE-Loader-Skript umschreiben

\newday{31}{8}
Circular Import gefixt. Neues skript \textit{spice\_loader} beinhaltet jetzt nur das Laden der Kernels. Evtl. später noch die Positions-Funktionen hierhin? \\[0.5cm]
Weiter das Plot-Skript dokumentieren, so einrichten, dass man mal easy(!) einen Punkt plotten kann ohne Epoche etc. angeben zu müssen (why??). Z.B. In- und Output der transform2eq-Methode...

\newday{3}{9}
Weiter: Schauen, was bei der Berechnung des Aspangles passiert: Müssten HCI und ECLIPJ2000 (hg und hc) nicht dasselbe in RTN sein? Beachte ich das überhaupt irgendwo? Dann müsste der AA nämlich auch gleich sein. Vielleicht muss der Ulysses-Vektor in RTN hart auf [R,0,0] gesetzt werden?

\newday{6}{9}
Das mit den Koordinatensystemen gefixt, passt nun bis zur ca. 3. Nachkommastelle.\\Als nächstes: calc\_SPE einbauen, also asp\_tot für den SPICE-Datensatz (habe keine unabhängige Quelle für die Berechnung des Winkels gefunden, aber das was ich in der Kladde gemacht habe sieht ganz schlau aus). Dann etwas mit den vier Plotfunktionen rumprobieren: Layout, Farben? (Vergleichen mit Abb. aus dem Vortrag). Docstrings einbauen in spice\_ulysses.py und in ul\_coordinates\_utils vervollständigen.

\newday{7}{9}
Checken, warum Archive-EC-Timesynchro nicht funktioniert. Dann schauen, ob alle Koordinaten-Longitudes jetzt passen. Dann weiter die 4 Plots durchgehen

\newday{8}{9}
Fehler gefunden, hatte den Datensatz durch eine falsche if-Loop in einer Komponente verkürzt. Weiter: Bei den comp-Funktionen die y-Achsen-Ranges freigeben und dann neu anpassen

\newday{12}{11}
In allen Skripten das mit d90-Schaltjahr ändern (s.o.), dann weiter versuchen load\_pui\_ulysses zum Laufen zu bringen (erstmal ohne SPICE, stattdessen mit alten Daten)

\newday{15}{11}
\textbf{Dinge, die mir unterwegs auffallen und die ich überarbeiten könnte:}\\
\begin{itemize}
	\item In dist3D d00 mit d90 ersetzen ?!
	\item In load\_pui\_ulysses: Warum muss ich nochmal über das Subset gehen? Testen, Lars ggf. fragen (und Bescheid sagen, dass in dbData wb und rb stehen muss in der save- und load-Funktion)
	\item Header aufräumen
	\item Geht das beim Bilden der aspangle-bins mit rechten Dingen zu? Passt das zusammen mit dem im Kollimator?
	\item wshellmax: ist das nicht falsch mit dem max der vsw? Mit kleinen vsw werden ja größere ws erreicht?
	\item Wird eigenvelocity richtig addiert in add\_3dv? Wo wird eigenvel. rtn definiert?
	\item warum Runden in add\_w?
	\item Warum Winkel in w? wofür? wie?
	\item Spin Reference Pulse nochmal durchdenken
\end{itemize}

\newdaytt{18}{01}
Hatte im November alles mit SPICE stehen und liegen gelassen, um Plots für die AGU mit alten Traj-Daten zu erzeugen. Jetzt:\\
\begin{itemize}
	\item SPICE einbauen und vergleichen, ob dieselben Spektren rauskommen \todo{SPICE}
	\begin{itemize}
		\item Parameter einbauen zum Wählen ob sync\_traj oder sync\_traj\_spice genutzt werden soll --- kann ich ganz einfach über zwei uswipha-Instanzen machen, jeweils die eine oder andere Methode drauf anwenden\done{Auswahl}
		\item Spektrum vergleichen \todo{Spektren vergl.}
		\item Eigengeschwindigkeit einbauen \done{Eigen-vel}
	\end{itemize}
	\item VHM\_FGM Magnetfelddaten runterladen; ---liegen auf \textit{data/projects/Ulysses/VHM\_FGM\_1min} \done{Download Mag-Daten}
	\item Magnetfelddaten einbauen... alte Struktur nutzen? Es gab eine Version, in denen die live gemappt wurden und eine mit fertigen Datenfiles \todo{sync Mag-Daten}
\end{itemize}
\newpage
Das SPICE-Skript (\textit{spice\_new\_inheri.py}) ist irgendwie so gar nicht vollständig: Funktion zum Wegschreiben fehlt. Ich habe nur ein Datenfile aus letztem Februar gefunden, das wahrscheinlich mit dem alten Skript \textit{spice\_ulysses.py} geschrieben wurde. Von da auch compare-Funktion einpflegen und Eigengeschwindigkeit etc. Dann mal gucken, was mit \textit{spice\_ulysses\_new} ist. Kann davon mal was weg?

\newdaytt{19}{01}
In \textit{spice\_ulysses\_new\_inheri.py} gibts schon comp-Funktionen. Allerdings funktioniert comp\_coords nicht in den Winkel-Komponenten \done{comp\_coords fixen} ---> hab die Achsenbegrenzungen rausgenommen, jetzt passts (nicht schön, aber geht erstmal)

\newdaytt{20}{01}
Musste in der Uni etspice neu installieren, funktionierte mit python3.9 nicht, kryptische Fehlermeldung. Lösung war \textit{python3.9 -m pip install --upgrade setuptools}\\

Jetzt Eigengeschwindigkeiten einbauen

\newdaytt{24}{01}
Eigengeschwindigkeit passt mit der alten überein. Jetzt neue Funktionen kommentieren, Berechnung für alle Koordinatensysteme möglich machen. Dann das Ganze wegschreiben. 

\newdaytt{25}{01}
Läuft für alle Koordinatensysteme, außerdem Fehler beim Berechnen der SPICE-AspAngles gefixt (glaube ich): \textit{calc\_delta} muss (bei den ekliptischen Systemen) für die Epoche berechnet werden, nicht für das entsprechende Datum (oder...?) der Trajektorie.\\
Next: Achsenbegrenzung Eigengeschw. anpassen \done{Achsen} und schauen, warum ich um 1995 doch eine kleine Abweichung zwischen ekl. und eq. Systemen (SPICE) hatte \done{Abweichung} <--- Abweichung war ein Typo (r statt v kopiert) und ein if-Case, der nicht ausgelöst wurde.

\newdaytt{26}{01}
Absolute Eigengeschwindigkeit einbauen \done{v\_abs}

\newdaytt{07}{02}
Auf dem Weg beim Vergleichen der Spektren mit sync\_traj() und sync\_traj\_spice() über d90 vs. doy gestolpert (angepasst) und darüber, dass man die PHAs evtl. noch feiner auflösen und feinere Trajektorien dazu benutzen könnte. Irgendwo gibt es auch so eine Funktion, die zur Zeit aber nicht in Betrieb ist. Evtl. später mal gucken. \todo{PHAs Zeitauflösung} \\[0.5cm]
Spektren nun stichprobenartig verglichen und passt soweit.\\
Jetzt etwas aufräumen und Kommentare schreiben...

\newdaytt{09}{02}
Habe heute die beiden alten Module spice\_ulysses.py und spice\_ulysses\_new.py gelöscht und spice\_ulysses\_new\_inheri.py umbenannt in spice\_ulysses.py. Alle Funktionalität wurde glaube ich nun übertragen ins neue Modul.

%
%
%
\end{document}